<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generatore QR Code Gratuito</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="tax-systems.js"></script>
    <script src="i18n.js"></script>
    <script src="country-selector.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body class="bg-gray-50">
    
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-8">
                    <a href="index.html" class="text-2xl font-bold text-blue-600">
                        <i class="fas fa-calculator"></i> Servizi Business
                    </a>
                    <nav class="hidden md:flex gap-6">
                        <a href="index.html" class="text-gray-700 hover:text-blue-600" data-i18n="home">Home</a>
                        <a href="#tools" class="text-gray-700 hover:text-blue-600" data-i18n="tools">Strumenti</a>
                    </nav>
                </div>
                
                <div class="flex items-center gap-4">
                    <div id="headerCountrySelector"></div>
                    
                    <div class="flex gap-1 border-l pl-4">
                        <button class="lang-btn px-3 py-1 rounded text-sm" data-lang="it">IT</button>
                        <button class="lang-btn px-3 py-1 rounded text-sm" data-lang="en">EN</button>
                        <button class="lang-btn px-3 py-1 rounded text-sm" data-lang="de">DE</button>
                        <button class="lang-btn px-3 py-1 rounded text-sm" data-lang="fr">FR</button>
                        <button class="lang-btn px-3 py-1 rounded text-sm" data-lang="es">ES</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-12">
        <div class="max-w-5xl mx-auto">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gray-800 mb-4" data-i18n="qrGeneratorTitle">Generatore QR Code</h1>
                <p class="text-xl text-gray-600" data-i18n="qrGeneratorSubtitle">Crea codici QR gratuiti per qualsiasi scopo</p>
            </div>
            
            <div class="grid lg:grid-cols-2 gap-8">
                <div class="bg-white rounded-2xl shadow-xl p-8">
                    <div class="mb-6">
                        <label class="block text-gray-700 font-semibold mb-3" data-i18n="qrType">Tipo di QR Code</label>
                        <div class="grid grid-cols-3 gap-3">
                            <button class="qr-type-btn active" data-type="url">
                                <i class="fas fa-link mb-2"></i>
                                <span data-i18n="qrTypeUrl">URL</span>
                            </button>
                            <button class="qr-type-btn" data-type="text">
                                <i class="fas fa-font mb-2"></i>
                                <span data-i18n="qrTypeText">Testo</span>
                            </button>
                            <button class="qr-type-btn" data-type="email">
                                <i class="fas fa-envelope mb-2"></i>
                                <span data-i18n="qrTypeEmail">Email</span>
                            </button>
                            <button class="qr-type-btn" data-type="phone">
                                <i class="fas fa-phone mb-2"></i>
                                <span data-i18n="qrTypePhone">Telefono</span>
                            </button>
                            <button class="qr-type-btn" data-type="sms">
                                <i class="fas fa-comment mb-2"></i>
                                <span data-i18n="qrTypeSms">SMS</span>
                            </button>
                            <button class="qr-type-btn" data-type="wifi">
                                <i class="fas fa-wifi mb-2"></i>
                                <span data-i18n="qrTypeWifi">WiFi</span>
                            </button>
                        </div>
                    </div>

                    <div id="urlForm" class="qr-form">
                        <label class="block text-gray-700 font-semibold mb-2" data-i18n="insertUrl">Inserisci URL</label>
                        <input type="url" id="urlInput" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:outline-none" placeholder="https://esempio.it">
                    </div>
                    
                    <div id="textForm" class="qr-form hidden">
                        <label class="block text-gray-700 font-semibold mb-2" data-i18n="insertText">Inserisci Testo</label>
                        <textarea id="textInput" rows="4" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:outline-none" placeholder="Scrivi il tuo testo qui..."></textarea>
                    </div>
                    
                    <div id="emailForm" class="qr-form hidden space-y-3">
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-i18n="emailRecipient">Email Destinatario</label>
                            <input type="email" id="emailInput" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg" placeholder="esempio@email.it">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-i18n="emailSubject">Oggetto (opzionale)</label>
                            <input type="text" id="emailSubject" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-i18n="emailBody">Messaggio (opzionale)</label>
                            <textarea id="emailBody" rows="3" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg"></textarea>
                        </div>
                    </div>
                    
                    <div id="phoneForm" class="qr-form hidden">
                        <label class="block text-gray-700 font-semibold mb-2" data-i18n="phoneNumber">Numero di Telefono</label>
                        <input type="tel" id="phoneInput" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg" placeholder="+39 123 456 7890">
                    </div>
                    
                    <div id="smsForm" class="qr-form hidden space-y-3">
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-i18n="phoneNumber">Numero Telefono</label>
                            <input type="tel" id="smsPhone" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg" placeholder="+39 123 456 7890">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-i18n="smsMessage">Messaggio</label>
                            <textarea id="smsMessage" rows="3" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg"></textarea>
                        </div>
                    </div>
                    
                    <div id="wifiForm" class="qr-form hidden space-y-3">
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-i18n="wifiSsid">Nome Rete (SSID)</label>
                            <input type="text" id="wifiSSID" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-i18n="wifiPassword">Password</label>
                            <input type="text" id="wifiPassword" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-i18n="wifiEncryption">Tipo Sicurezza</label>
                            <select id="wifiEncryption" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg">
                                <option value="WPA" data-i18n="wifiEncWpa">WPA/WPA2</option>
                                <option value="WEP" data-i18n="wifiEncWep">WEP</option>
                                <option value="" data-i18n="wifiEncNone">Nessuna</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <label class="block text-gray-700 font-semibold mb-2" data-i18n="qrSize">Dimensione QR Code</label>
                        <input type="range" id="qrSize" min="128" max="512" value="256" step="64" class="w-full">
                        <div class="text-center text-sm text-gray-600 mt-1">
                            <span id="sizeValue">256</span> x <span id="sizeValue2">256</span> px
                        </div>
                    </div>
                    
                    <button id="generateBtn" class="w-full mt-6 bg-blue-600 text-white px-6 py-4 rounded-lg font-semibold text-lg hover:bg-blue-700 transition">
                        <i class="fas fa-qrcode mr-2"></i>
                        <span data-i18n="generateQr">Genera QR Code</span>
                    </button>
                </div>
                
                <div class="bg-white rounded-2xl shadow-xl p-8">
                    <h2 class="text-xl font-bold text-gray-800 mb-6 text-center" data-i18n="qrPreview">Anteprima QR Code</h2>
                    <div id="qrcodeContainer" class="flex justify-center items-center mb-6 min-h-[256px] bg-gray-50 rounded-lg p-8">
                        <div class="text-center text-gray-400">
                            <i class="fas fa-qrcode text-6xl mb-4"></i>
                            <p data-i18n="qrPlaceholder">Il QR code apparir√† qui</p>
                        </div>
                    </div>
                    <div id="downloadSection" class="hidden space-y-3">
                        <button id="downloadBtn" class="w-full bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition">
                            <i class="fas fa-download mr-2"></i>
                            <span data-i18n="downloadPng">Scarica PNG</span>
                        </button>
                        <button id="resetBtn" class="w-full bg-gray-200 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-300 transition">
                            <i class="fas fa-redo mr-2"></i>
                            <span data-i18n="createNew">Crea Nuovo</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <style>
        .qr-type-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: .5rem;
            background: #fff;
            cursor: pointer;
            transition: all .2s;
            font-size: .875rem;
            color: #6b7280;
        }
        .qr-type-btn:hover {
            border-color: #3b82f6;
            background: #eff6ff;
        }
        .qr-type-btn.active {
            border-color: #3b82f6;
            background: #3b82f6;
            color: #fff;
        }
        .qr-type-btn i {
            font-size: 1.5rem;
        }
        .lang-btn {
            background: #f3f4f6;
            color: #6b7280;
            transition: all 0.2s;
        }
        .lang-btn.active {
            background: #3b82f6;
            color: white;
        }
    </style>
    
    <script>
        let currentType = 'url';
        let qrcode = null;

        document.addEventListener('DOMContentLoaded', function() {
            setupQRGenerator();
            setupLanguageButtons();
        });

        function setupQRGenerator() {
            document.querySelectorAll('.qr-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.qr-type-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentType = this.dataset.type;
                    document.querySelectorAll('.qr-form').forEach(form => form.classList.add('hidden'));
                    document.getElementById(currentType + 'Form').classList.remove('hidden');
                });
            });

            document.getElementById('qrSize').addEventListener('input', function() {
                document.getElementById('sizeValue').textContent = this.value;
                document.getElementById('sizeValue2').textContent = this.value;
            });

            document.getElementById('generateBtn').addEventListener('click', generateQR);

            document.getElementById('resetBtn').addEventListener('click', function() {
                document.getElementById('qrcodeContainer').innerHTML = `<div class="text-center text-gray-400"><i class="fas fa-qrcode text-6xl mb-4"></i><p data-i18n="qrPlaceholder">${t('qrPlaceholder')}</p></div>`;
                document.getElementById('downloadSection').classList.add('hidden');
                qrcode = null;
            });

            document.getElementById('downloadBtn').addEventListener('click', function() {
                const canvas = document.querySelector('#qrcodeContainer canvas');
                if (canvas) {
                    const link = document.createElement('a');
                    link.download = 'qrcode.png';
                    link.href = canvas.toDataURL();
                    link.click();
                }
            });
        }

        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    setLanguage(this.dataset.lang);
                });
            });
        }

        function generateQR() {
            let text = '';
            switch(currentType) {
                case 'url':
                    text = document.getElementById('urlInput').value;
                    if (!text) { alert('Inserisci un URL'); return; }
                    break;
                case 'text':
                    text = document.getElementById('textInput').value;
                    if (!text) { alert('Inserisci un testo'); return; }
                    break;
                case 'email':
                    const email = document.getElementById('emailInput').value;
                    const subject = document.getElementById('emailSubject').value;
                    const body = document.getElementById('emailBody').value;
                    if (!email) { alert('Inserisci un indirizzo email'); return; }
                    text = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                    break;
                case 'phone':
                    const phone = document.getElementById('phoneInput').value;
                    if (!phone) { alert('Inserisci un numero di telefono'); return; }
                    text = `tel:${phone}`;
                    break;
                case 'sms':
                    const smsPhone = document.getElementById('smsPhone').value;
                    const smsMsg = document.getElementById('smsMessage').value;
                    if (!smsPhone) { alert('Inserisci un numero di telefono'); return; }
                    text = `sms:${smsPhone}?body=${encodeURIComponent(smsMsg)}`;
                    break;
                case 'wifi':
                    const ssid = document.getElementById('wifiSSID').value;
                    const pass = document.getElementById('wifiPassword').value;
                    const enc = document.getElementById('wifiEncryption').value;
                    if (!ssid) { alert('Inserisci il nome della rete WiFi'); return; }
                    text = `WIFI:T:${enc};S:${ssid};P:${pass};;`;
                    break;
            }
            
            const size = parseInt(document.getElementById('qrSize').value);
            document.getElementById('qrcodeContainer').innerHTML = '';
            qrcode = new QRCode(document.getElementById('qrcodeContainer'), {
                text: text,
                width: size,
                height: size,
                colorDark: '#000000',
                colorLight: '#ffffff',
                correctLevel: QRCode.CorrectLevel.H
            });
            document.getElementById('downloadSection').classList.remove('hidden');
        }
    </script>
</body>
</html>